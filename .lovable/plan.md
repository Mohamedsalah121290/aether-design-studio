
# ايه اللي ناقص على المنصة؟ - تحليل شامل

## الوضع الحالي

المنصة دلوقتي فيها:
- **متجر أدوات AI** (Storefront): بيعرض أدوات ذكاء اصطناعي مع أسعار شهرية وزرار "اشتري دلوقتي"
- **نظام طلبات** (Orders): المستخدم بيطلب أداة، الأدمن بيفعّلها يدوي
- **My Vault**: المستخدم بيشوف حالة طلباته (Pending / Active)
- **Academy**: صفحة دروس تعليمية ثابتة (hardcoded) - مش متربطة بقاعدة بيانات
- **نظام تسجيل دخول** وأدوار (admin/user)

---

## اللي ناقص عشان المنصة تكمل

### 1. نظام دفع حقيقي (Stripe Integration)
حاليًا مفيش أي بوابة دفع. المستخدم بيعمل "طلب" بس من غير ما يدفع فعلاً. المطلوب:
- ربط Stripe لمعالجة المدفوعات
- دعم الاشتراكات الشهرية المتكررة (recurring subscriptions)
- دعم الدفع لمرة واحدة (one-time payments) للدورات التعليمية
- Webhook لتحديث حالة الطلب تلقائيًا بعد الدفع

### 2. إدارة الاشتراكات (Subscription Management)
حاليًا مفيش تتبع لحالة الاشتراك (نشط / منتهي / ملغي). المطلوب:
- جدول `subscriptions` في قاعدة البيانات يتتبع: تاريخ البداية، تاريخ التجديد، الحالة
- منطق التجديد التلقائي أو الإلغاء
- صفحة "اشتراكاتي" في الداشبورد تعرض تفاصيل الاشتراك وإمكانية الإلغاء
- إشعارات قبل انتهاء الاشتراك

### 3. المحتوى التعليمي الديناميكي (Academy Backend)
صفحة الأكاديمي حاليًا كلها بيانات ثابتة (mock data). المطلوب:
- جدول `courses` و `lessons` في قاعدة البيانات
- لوحة إدارة للأدمن لإضافة/تعديل الدروس
- نظام تتبع تقدم المستخدم في قاعدة البيانات (مش localStorage)
- ربط الدورات بالدفع (دورة مجانية vs مدفوعة)

### 4. إشعارات البريد الإلكتروني
مفيش أي نظام إشعارات. المطلوب:
- إرسال إيميل تأكيد بعد الشراء
- إرسال إيميل لما الطلب يتفعّل
- تذكير قبل انتهاء الاشتراك

### 5. صفحة بروفايل المستخدم
مفيش صفحة بروفايل. المطلوب:
- عرض بيانات المستخدم
- تاريخ المشتريات
- إدارة طريقة الدفع
- تغيير اللغة المفضلة

### 6. تفعيل تلقائي للطلبات
حاليًا الأدمن بيفعّل كل طلب يدوي. المطلوب (لبعض الأنواع):
- تفعيل تلقائي بعد تأكيد الدفع لنوع `provide_account`
- إرسال بيانات الحساب تلقائيًا للمستخدم

---

## الأولوية المقترحة

| الأولوية | المهمة | السبب |
|----------|--------|-------|
| 1 | ربط Stripe | بدون دفع مفيش بيزنس حقيقي |
| 2 | إدارة الاشتراكات | أساس نموذج العمل |
| 3 | إشعارات البريد | تجربة مستخدم أساسية |
| 4 | Academy Backend | تحويل الدروس لمحتوى ديناميكي |
| 5 | بروفايل المستخدم | تحسين تجربة المستخدم |
| 6 | تفعيل تلقائي | تقليل العمل اليدوي |

---

## التفاصيل التقنية

### Stripe Integration
- تفعيل Stripe connector المدمج في المنصة
- إنشاء Edge Function للتعامل مع Stripe webhooks
- إنشاء Checkout Session لكل عملية شراء
- تحديث جدول `orders` تلقائيًا بعد الدفع

### جدول الاشتراكات المقترح
```text
subscriptions
├── id (uuid)
├── user_id (uuid)
├── order_id (uuid)
├── stripe_subscription_id (text)
├── status (active/cancelled/past_due/expired)
├── current_period_start (timestamp)
├── current_period_end (timestamp)
├── cancel_at_period_end (boolean)
├── created_at (timestamp)
└── updated_at (timestamp)
```

### جداول الأكاديمي المقترحة
```text
courses
├── id (uuid)
├── title (text)
├── description (text)
├── category (text)
├── difficulty (text)
├── thumbnail_url (text)
├── is_free (boolean)
├── price (numeric, nullable)
├── is_published (boolean)
└── created_at (timestamp)

lessons
├── id (uuid)
├── course_id (uuid, FK)
├── title (text)
├── content_type (video/article)
├── content_url (text)
├── duration (text)
├── sort_order (integer)
└── created_at (timestamp)

user_progress
├── id (uuid)
├── user_id (uuid)
├── lesson_id (uuid, FK)
├── completed (boolean)
└── completed_at (timestamp)
```

---

## الخطوة التالية المقترحة

أنصح نبدأ بـ **ربط Stripe** لأنه الأساس اللي كل حاجة تانية بتعتمد عليه. بعد كده نبني نظام الاشتراكات وبعدين باقي المهام.

هل تحب نبدأ بأي مهمة من دول؟
